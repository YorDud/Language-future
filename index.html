<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="ico.png">
    <title>Язык будущего | Контекстно-зависимый генератор</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0c1c2e, #1a365d, #2d4a6e);
            color: #e6f2ff;
            min-height: 100vh;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
            padding: 15px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(12, 32, 66, 0.8);
            border-radius: 18px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(64, 156, 255, 0.3);
            backdrop-filter: blur(10px);
            width: 100%;
        }

        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            background: linear-gradient(to right, #4facfe, #00c6fb, #00d4ff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 3px 12px rgba(0, 0, 0, 0.2);
            line-height: 1.2;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .tagline {
            font-size: 1.1rem;
            color: #b3e0ff;
            margin-bottom: 15px;
            line-height: 1.4;
        }

        .main-app {
            display: flex;
            flex-direction: column;
            gap: 25px;
            width: 100%;
        }

        .input-section {
            background: rgba(18, 40, 76, 0.8);
            padding: 25px;
            border-radius: 18px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(64, 156, 255, 0.2);
            backdrop-filter: blur(10px);
            width: 100%;
        }

        h2 {
            font-size: 1.7rem;
            margin-bottom: 20px;
            color: #4facfe;
            display: flex;
            align-items: center;
            gap: 10px;
            line-height: 1.3;
        }

        h2 i {
            color: #00c6fb;
        }

        .input-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 100%;
        }

        .definition-input {
            width: 100%;
            min-height: 130px;
            padding: 18px;
            background: rgba(8, 22, 44, 0.9);
            border: 2px solid #2a4d7c;
            border-radius: 12px;
            color: #e6f2ff;
            font-size: 1.1rem;
            line-height: 1.5;
            resize: vertical;
            transition: all 0.3s;
            box-sizing: border-box;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .definition-input:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.2);
        }

        .input-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
            width: 100%;
        }

        .btn {
            padding: 14px 20px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
            flex: 1;
            min-width: 180px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            box-sizing: border-box;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(to right, #1a73e8, #4facfe);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(to right, #4facfe, #1a73e8);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(79, 172, 254, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(to right, #37474f, #546e7a);
            color: white;
        }

        .btn-secondary:hover {
            background: linear-gradient(to right, #546e7a, #37474f);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(84, 110, 122, 0.4);
        }

        .btn-danger {
            background: linear-gradient(to right, #c62828, #ef5350);
            color: white;
        }

        .btn-danger:hover {
            background: linear-gradient(to right, #ef5350, #c62828);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(239, 83, 80, 0.4);
        }

        .btn-success {
            background: linear-gradient(to right, #2e7d32, #4caf50);
            color: white;
        }

        .btn-success:hover {
            background: linear-gradient(to right, #4caf50, #2e7d32);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(76, 175, 80, 0.4);
        }

        .btn-info {
            background: linear-gradient(to right, #0066cc, #3399ff);
            color: white;
        }

        .btn-info:hover {
            background: linear-gradient(to right, #3399ff, #0066cc);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(51, 153, 255, 0.4);
        }

        .voice-status {
            margin-top: 15px;
            padding: 15px;
            border-radius: 12px;
            background: rgba(8, 22, 44, 0.9);
            display: none;
            align-items: center;
            gap: 15px;
            border-left: 5px solid #4facfe;
            width: 100%;
            box-sizing: border-box;
        }

        .voice-active {
            display: flex;
            background: rgba(25, 80, 120, 0.4);
            border: 1px solid #00c6fb;
        }

        .pulse {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4facfe;
            animation: pulse 1.5s infinite;
            box-shadow: 0 0 10px #4facfe;
            flex-shrink: 0;
        }

        @keyframes pulse {
            0% { transform: scale(0.9); opacity: 0.7; }
            50% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(0.9); opacity: 0.7; }
        }

        .result-section {
            background: rgba(18, 40, 76, 0.8);
            padding: 25px;
            border-radius: 18px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(64, 156, 255, 0.2);
            backdrop-filter: blur(10px);
            display: none;
            width: 100%;
            box-sizing: border-box;
        }

        .result-section.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .generated-word {
            text-align: center;
            margin-bottom: 25px;
            padding: 20px;
            background: rgba(8, 22, 44, 0.9);
            border-radius: 15px;
            border: 2px solid #2a4d7c;
            width: 100%;
            box-sizing: border-box;
            overflow-wrap: break-word;
            word-wrap: break-word;
        }

        .word {
            font-size: 3.2rem;
            font-weight: bold;
            color: #4facfe;
            margin-bottom: 12px;
            text-shadow: 0 3px 12px rgba(0, 0, 0, 0.3);
            letter-spacing: 0.5px;
            line-height: 1.2;
            word-break: break-word;
            overflow-wrap: break-word;
        }

        .definition {
            font-size: 1.2rem;
            color: #b3e0ff;
            line-height: 1.6;
            margin: 0 auto;
            word-wrap: break-word;
            overflow-wrap: break-word;
            padding: 0 5px;
        }

        .word-details {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
            width: 100%;
        }

        .detail-card {
            background: rgba(30, 60, 114, 0.6);
            padding: 15px;
            border-radius: 10px;
            min-width: 180px;
            text-align: center;
            flex: 1;
            box-sizing: border-box;
            max-width: 300px;
        }

        .detail-title {
            font-size: 0.85rem;
            color: #80d0ff;
            margin-bottom: 5px;
        }

        .detail-value {
            font-size: 1.1rem;
            color: #4facfe;
            font-weight: bold;
            word-break: break-word;
        }

        .article-section {
            background: rgba(8, 22, 44, 0.9);
            padding: 25px;
            border-radius: 15px;
            margin-top: 20px;
            border: 2px solid #2a4d7c;
            display: none;
            width: 100%;
            box-sizing: border-box;
            overflow-wrap: break-word;
            word-wrap: break-word;
        }

        .article-section.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        .article-title {
            font-size: 1.7rem;
            color: #4facfe;
            margin-bottom: 15px;
            text-align: center;
            padding-bottom: 12px;
            border-bottom: 2px solid #2a4d7c;
            line-height: 1.3;
            word-break: break-word;
        }

        .article-content {
            line-height: 1.7;
            color: #d1e9ff;
            font-size: 1.05rem;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .article-content p {
            margin-bottom: 18px;
            text-align: left;
            word-break: break-word;
        }

        .examples {
            margin-top: 20px;
            padding: 18px;
            background: rgba(30, 60, 114, 0.6);
            border-radius: 12px;
            border-left: 5px solid #4facfe;
            box-sizing: border-box;
        }

        .examples h4 {
            color: #4facfe;
            margin-bottom: 12px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .examples ul {
            padding-left: 20px;
        }

        .examples li {
            margin-bottom: 10px;
            line-height: 1.5;
            word-break: break-word;
        }

        .article-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 25px;
            justify-content: center;
            width: 100%;
        }

        footer {
            margin-top: 40px;
            text-align: center;
            padding: 20px;
            color: #88d3fa;
            font-size: 0.95rem;
            border-top: 1px solid rgba(64, 156, 255, 0.3);
            width: 100%;
            background: rgba(12, 32, 66, 0.5);
            border-radius: 15px;
            box-sizing: border-box;
        }

        .examples-list {
            margin-top: 25px;
            background: rgba(12, 32, 66, 0.7);
            padding: 20px;
            border-radius: 15px;
            width: 100%;
            box-sizing: border-box;
        }

        .examples-list h3 {
            color: #4facfe;
            margin-bottom: 15px;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .example-item {
            padding: 16px;
            background: rgba(8, 22, 44, 0.9);
            border-radius: 10px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 4px solid transparent;
            border: 1px solid #2a4d7c;
            box-sizing: border-box;
            width: 100%;
        }

        .example-item:hover {
            border-left: 4px solid #4facfe;
            background: rgba(30, 60, 114, 0.6);
            transform: translateX(5px);
        }

        .example-title {
            font-weight: bold;
            color: #80d0ff;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1rem;
        }

        .example-text {
            color: #c2e0ff;
            line-height: 1.4;
            font-size: 0.95rem;
        }

        .speech-status {
            margin-top: 15px;
            padding: 15px;
            border-radius: 12px;
            background: rgba(30, 60, 114, 0.6);
            display: none;
            align-items: center;
            gap: 15px;
            border-left: 5px solid #4caf50;
            width: 100%;
            box-sizing: border-box;
        }

        .speech-active {
            display: flex;
            background: rgba(25, 100, 60, 0.4);
            border: 1px solid #4caf50;
        }

        .context-match {
            margin-top: 15px;
            padding: 12px 15px;
            border-radius: 8px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 8px;
            width: 100%;
            box-sizing: border-box;
        }

        .high-match {
            background-color: rgba(76, 175, 80, 0.2);
            color: #a5d6a7;
            border-left: 3px solid #4caf50;
        }

        .medium-match {
            background-color: rgba(255, 193, 7, 0.2);
            color: #ffecb3;
            border-left: 3px solid #ffc107;
        }

        .low-match {
            background-color: rgba(244, 67, 54, 0.2);
            color: #ffcdd2;
            border-left: 3px solid #f44336;
        }

        .custom-match {
            background-color: rgba(103, 58, 183, 0.2);
            color: #d1c4e9;
            border-left: 3px solid #673ab7;
        }

        .legalize-btn {
            margin-top: 20px;
            text-align: center;
            width: 100%;
        }

        /* Адаптивность для мобильных устройств */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 10px;
                max-width: 100%;
            }
            
            header {
                padding: 18px 15px;
                margin-bottom: 20px;
                border-radius: 16px;
            }
            
            h1 {
                font-size: 2.2rem;
                line-height: 1.2;
            }
            
            .tagline {
                font-size: 1rem;
                line-height: 1.3;
            }
            
            .input-section, .result-section {
                padding: 20px 15px;
                border-radius: 16px;
            }
            
            h2 {
                font-size: 1.5rem;
                margin-bottom: 15px;
            }
            
            .definition-input {
                font-size: 1rem;
                padding: 15px;
                min-height: 120px;
            }
            
            .btn {
                padding: 12px 15px;
                font-size: 0.95rem;
                min-width: 100%;
                margin-bottom: 5px;
            }
            
            .input-buttons {
                gap: 10px;
            }
            
            .word {
                font-size: 2.5rem;
                margin-bottom: 10px;
            }
            
            .definition {
                font-size: 1.1rem;
                line-height: 1.5;
            }
            
            .word-details {
                flex-direction: column;
                align-items: stretch;
                gap: 15px;
            }
            
            .detail-card {
                min-width: 100%;
                max-width: 100%;
                padding: 12px 15px;
            }
            
            .detail-title {
                font-size: 0.8rem;
            }
            
            .detail-value {
                font-size: 1rem;
            }
            
            .article-section {
                padding: 20px 15px;
            }
            
            .article-title {
                font-size: 1.5rem;
                padding-bottom: 10px;
            }
            
            .article-content {
                font-size: 1rem;
                line-height: 1.6;
            }
            
            .article-content p {
                margin-bottom: 15px;
            }
            
            .examples-list {
                padding: 18px 15px;
            }
            
            .examples-list h3 {
                font-size: 1.3rem;
            }
            
            .example-item {
                padding: 14px;
            }
            
            .example-title {
                font-size: 0.95rem;
            }
            
            .example-text {
                font-size: 0.9rem;
            }
            
            footer {
                padding: 18px 15px;
                font-size: 0.9rem;
            }
            
            .article-buttons .btn {
                min-width: 100%;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.9rem;
            }
            
            .word {
                font-size: 2.2rem;
            }
            
            .definition {
                font-size: 1rem;
            }
            
            .btn {
                padding: 10px 12px;
                font-size: 0.9rem;
            }
            
            .article-title {
                font-size: 1.3rem;
            }
            
            .article-content {
                font-size: 0.95rem;
            }
            
            .examples h4 {
                font-size: 1.1rem;
            }
            
            .voice-status, .speech-status {
                padding: 12px;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 360px) {
            h1 {
                font-size: 1.7rem;
            }
            
            .word {
                font-size: 1.9rem;
            }
            
            .btn {
                padding: 9px 10px;
                font-size: 0.85rem;
            }
            
            .article-title {
                font-size: 1.2rem;
            }
        }

        /* Для очень длинных слов */
        .word, .article-title, .article-content, .definition, .detail-value {
            overflow-wrap: break-word;
            word-wrap: break-word;
            hyphens: auto;
        }

        /* Улучшение прокрутки на мобильных */
        @media (max-width: 768px) {
            body {
                -webkit-overflow-scrolling: touch;
            }
            
            .generated-word, .article-section, .examples {
                max-height: none;
                overflow-y: visible;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-language"></i> Язык будущего</h1>
            <p class="tagline">Контекстно-зависимый генератор новых слов с умным анализом описания</p>
        </header>
        
        <div class="main-app">
            <section class="input-section">
                <h2><i class="fas fa-keyboard"></i> Опишите новое понятие</h2>
                <div class="input-container">
                    <textarea id="definitionInput" class="definition-input" placeholder="Опишите понятие, для которого нужно создать новое слово. Чем подробнее описание, тем точнее будет сгенерированное слово. Например: 'должность человека который будет обучать роботов' или 'термин для смешанного чувства восхищения и тревоги при общении с эмпатичным ИИ'"></textarea>
                    
                    <div class="input-buttons">
                        <button id="generateBtn" class="btn btn-primary">
                            <i class="fas fa-brain"></i> Сгенерировать слово
                        </button>
                        <button id="voiceBtn" class="btn btn-secondary">
                            <i class="fas fa-microphone"></i> Голосовой ввод
                        </button>
                        <button id="clearBtn" class="btn btn-danger">
                            <i class="fas fa-trash-alt"></i> Очистить
                        </button>
                    </div>
                    
                    <div id="voiceStatus" class="voice-status">
                        <div class="pulse"></div>
                        <span>Говорите сейчас... Я слушаю. Чтобы остановить, нажмите кнопку "Голосовой ввод" еще раз.</span>
                    </div>
                </div>
                
                <div class="examples-list">
                    <h3><i class="fas fa-lightbulb"></i> Примеры для вдохновения</h3>
                    <div class="example-item" data-example="должность человека который будет обучать роботов">
                        <div class="example-title"><i class="fas fa-robot"></i> Профессия будущего</div>
                        <div class="example-text">Специалист по обучению и адаптации роботизированных систем</div>
                    </div>
                    <div class="example-item" data-example="термин для смешанного чувства восхищения и тревоги при общении с эмпатичным ИИ">
                        <div class="example-title"><i class="fas fa-heart"></i> Эмоция будущего</div>
                        <div class="example-text">Сложное эмоциональное состояние при взаимодействии с эмоционально-развитым искусственным интеллектом</div>
                    </div>
                    <div class="example-item" data-example="устройство для перевода мыслей в текст в реальном времени">
                        <div class="example-title"><i class="fas fa-brain"></i> Технология будущего</div>
                        <div class="example-text">Гаджет для преобразования нейронных сигналов в письменную речь</div>
                    </div>
                    <div class="example-item" data-example="профессия специалиста по исправлению ошибок в работе нейронных сетей">
                        <div class="example-title"><i class="fas fa-user-graduate"></i> Профессия будущего</div>
                        <div class="example-text">Эксперт по отладке и коррекции искусственных нейронных сетей</div>
                    </div>
                </div>
            </section>
            
            <section id="resultSection" class="result-section">
                <div class="generated-word">
                    <div class="word" id="generatedWord">Роботьютор</div>
                    <div class="definition" id="generatedDefinition"></div>
                    
                    <div id="contextMatch" class="context-match high-match">
                        <i class="fas fa-check-circle"></i>
                        <span>Высокое соответствие контексту: слово точно отражает описание</span>
                    </div>
                    
                    <div class="word-details">
                        <div class="detail-card">
                            <div class="detail-title">Тип слова</div>
                            <div class="detail-value" id="wordType">Существительное</div>
                        </div>
                        <div class="detail-card">
                            <div class="detail-title">Сфера применения</div>
                            <div class="detail-value" id="wordDomain">Робототехника</div>
                        </div>
                        <div class="detail-card">
                            <div class="detail-title">Уровень соответствия</div>
                            <div class="detail-value" id="wordComplexity">Высокий</div>
                        </div>
                    </div>
                </div>
                
                <div class="legalize-btn">
                    <button id="legalizeBtn" class="btn btn-success">
                        <i class="fas fa-file-contract"></i> Узнать больше о слове
                    </button>
                </div>
                
                <div id="speechStatus" class="speech-status">
                    <div class="pulse" style="background: #4caf50;"></div>
                    <span>Идет озвучивание статьи... Нажмите на кнопку еще раз, чтобы остановить.</span>
                </div>
                
                <div id="articleSection" class="article-section">
                    <h3 class="article-title" id="articleTitle">Научная статья: "Роботьютор"</h3>
                    <div class="article-content" id="articleContent">
                        <!-- Статья будет сгенерирована здесь -->
                    </div>
                    
                    <div class="article-buttons">
                        <button id="speakBtn" class="btn btn-info">
                            <i class="fas fa-volume-up"></i> Озвучить статью
                        </button>
                        <button id="stopSpeakBtn" class="btn btn-danger">
                            <i class="fas fa-stop-circle"></i> Остановить озвучивание
                        </button>
                    </div>
                </div>
            </section>
        </div>
        
        <footer>
            <p><i class="fas fa-robot"></i> «Язык будущего» — умный генератор новых слов с контекстным анализом</p>
            <p>© 2025 Все созданные термины являются интеллектуальной собственностью их авторов: YORIK & Дударев Мирослав Александрович</p>
        </footer>
    </div>

    <script>
        // Элементы DOM
        const definitionInput = document.getElementById('definitionInput');
        const generateBtn = document.getElementById('generateBtn');
        const voiceBtn = document.getElementById('voiceBtn');
        const clearBtn = document.getElementById('clearBtn');
        const voiceStatus = document.getElementById('voiceStatus');
        const resultSection = document.getElementById('resultSection');
        const generatedWord = document.getElementById('generatedWord');
        const generatedDefinition = document.getElementById('generatedDefinition');
        const contextMatch = document.getElementById('contextMatch');
        const wordType = document.getElementById('wordType');
        const wordDomain = document.getElementById('wordDomain');
        const wordComplexity = document.getElementById('wordComplexity');
        const legalizeBtn = document.getElementById('legalizeBtn');
        const articleSection = document.getElementById('articleSection');
        const articleTitle = document.getElementById('articleTitle');
        const articleContent = document.getElementById('articleContent');
        const exampleItems = document.querySelectorAll('.example-item');
        const speakBtn = document.getElementById('speakBtn');
        const stopSpeakBtn = document.getElementById('stopSpeakBtn');
        const speechStatus = document.getElementById('speechStatus');
        
        // Инициализация голосового ввода
        let recognition = null;
        let isListening = false;
        let currentWord = "";
        let currentWordData = null;
        let speechSynthesis = window.speechSynthesis;
        let isSpeaking = false;
        let currentUtterance = null;
        
        // Проверяем поддержку Web Speech API (распознавание)
        function initSpeechRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                recognition = new SpeechRecognition();
                recognition.lang = 'ru-RU';
                recognition.interimResults = true; // Показываем промежуточные результаты
                recognition.continuous = true; // Непрерывное распознавание
                recognition.maxAlternatives = 1;
                
                recognition.onstart = function() {
                    isListening = true;
                    voiceStatus.classList.add('voice-active');
                    voiceBtn.innerHTML = '<i class="fas fa-microphone-slash"></i> Остановить запись';
                    voiceBtn.classList.remove('btn-secondary');
                    voiceBtn.classList.add('btn-danger');
                    definitionInput.placeholder = "Говорите сейчас...";
                };
                
                recognition.onresult = function(event) {
                    let finalTranscript = '';
                    
                    for (let i = event.resultIndex; i < event.results.length; i++) {
                        const transcript = event.results[i][0].transcript;
                        
                        if (event.results[i].isFinal) {
                            // Финализированный текст
                            finalTranscript += transcript;
                        }
                    }
                    
                    // Добавляем распознанный текст в поле ввода
                    if (finalTranscript.trim()) {
                        // Если поле пустое, просто устанавливаем текст
                        // Если в поле уже есть текст, добавляем к нему
                        const currentValue = definitionInput.value.trim();
                        if (currentValue) {
                            definitionInput.value = currentValue + ' ' + finalTranscript;
                        } else {
                            definitionInput.value = finalTranscript;
                        }
                        
                        // Автоматически прокручиваем поле ввода к концу текста
                        definitionInput.scrollTop = definitionInput.scrollHeight;
                        
                        // Фокусируем на поле ввода
                        definitionInput.focus();
                    }
                };
                
                recognition.onend = function() {
                    isListening = false;
                    voiceStatus.classList.remove('voice-active');
                    voiceBtn.innerHTML = '<i class="fas fa-microphone"></i> Голосовой ввод';
                    voiceBtn.classList.remove('btn-danger');
                    voiceBtn.classList.add('btn-secondary');
                    definitionInput.placeholder = "Опишите понятие, для которого нужно создать новое слово...";
                };
                
                recognition.onerror = function(event) {
                    console.error('Ошибка распознавания речи: ', event.error);
                    isListening = false;
                    voiceStatus.classList.remove('voice-active');
                    voiceBtn.innerHTML = '<i class="fas fa-microphone"></i> Голосовой ввод';
                    voiceBtn.classList.remove('btn-danger');
                    voiceBtn.classList.add('btn-secondary');
                    definitionInput.placeholder = "Опишите понятие, для которого нужно создать новое слово...";
                    
                    if (event.error === 'not-allowed') {
                        alert('Доступ к микрофону запрещен. Пожалуйста, разрешите использование микрофона в настройках браузера.');
                    } else if (event.error === 'audio-capture') {
                        alert('Не удалось получить доступ к микрофону. Убедитесь, что микрофон подключен и разрешен для использования.');
                    } else if (event.error === 'network') {
                        alert('Ошибка сети при распознавании речи. Проверьте подключение к интернету.');
                    } else if (event.error === 'no-speech') {
                        // Это нормально, пользователь ничего не сказал
                        console.log('Речь не обнаружена');
                    } else {
                        console.log('Ошибка распознавания речи: ' + event.error);
                    }
                };
            } else {
                // Браузер не поддерживает распознавание речи
                voiceBtn.disabled = true;
                voiceBtn.innerHTML = '<i class="fas fa-microphone-slash"></i> Голосовой ввод не поддерживается';
                voiceBtn.title = 'Ваш браузер не поддерживает голосовой ввод. Пожалуйста, используйте последние версии Chrome, Edge или Safari.';
                
                // Информационное сообщение для пользователя
                voiceBtn.addEventListener('click', function() {
                    alert('Голосовой ввод не поддерживается вашим браузером. Пожалуйста, используйте последние версии Chrome, Edge или Safari для доступа к этой функции.');
                });
            }
        }
        
        // Инициализируем распознавание речи при загрузке страницы
        initSpeechRecognition();
        
        // Проверяем поддержку синтеза речи
        if (!speechSynthesis) {
            speakBtn.disabled = true;
            speakBtn.innerHTML = '<i class="fas fa-volume-mute"></i> Озвучивание не поддерживается';
            speakBtn.title = 'Ваш браузер не поддерживает синтез речи';
        }
        
        // УЛУЧШЕННАЯ СИСТЕМА АНАЛИЗА КОНТЕКСТА С БОЛЬШИМ КОЛИЧЕСТВОМ КАТЕГОРИЙ
        const contextPatterns = {
    // Роботы и ИИ (расширенная версия)
    robotics: {
        keywords: ['робот', 'робототехник', 'искусственн', 'нейрон', 'алгоритм', 'машинн', 'ии', 'бот', 'автомат', 'автономн', 'кибернетик', 'систем искусствен', 'нейросет', 'глубинн', 'компьютерн', 'цифров', 'виртуал'],
        prefixes: ['Робо', 'Кибер', 'Техно', 'Алго', 'Нейро', 'Ай', 'Авто', 'Механо', 'Диги', 'Бионик', 'Смарт', 'Когни', 'Интеллект', 'Машин', 'АвтоТех', 'Робот', 'Электро', 'Программ', 'Вирту'],
        roots: ['тьютор', 'тренер', 'инструктор', 'педагог', 'обучатель', 'ментор', 'наставник', 'мастер', 'коуч', 'ассистент', 'помощник', 'консультант', 'эксперт', 'специалист', 'инженер', 'разработчик', 'программист', 'аналитик', 'архитектор', 'дизайнер', 'тестировщик', 'оптимизатор', 'модератор', 'куратор', 'супервизор'],
        suffixes: ['', 'ист', 'ер', 'ор', 'ант', 'щик', 'ик', 'атор', 'ент', 'еро'],
        domain: 'Робототехника и ИИ',
        wordType: 'Название профессии',
        templates: [
            "{word} - специалист по {activity} {objects}.",
            "{word} - профессионал, занимающийся {process} {systems}.",
            "{word} - эксперт в области {field}, отвечающий за {responsibility}.",
            "{word} - ключевой специалист в сфере {domain}, осуществляющий {function}."
        ],
        activities: ['обучению и адаптации', 'тренировке и настройке', 'программированию и калибровке', 'мониторингу и оптимизации', 'интеграции и внедрению', 'диагностике и ремонту', 'разработке и тестированию'],
        objects: ['роботизированных систем', 'искусственных интеллектов', 'автономных машин', 'нейронных сетей', 'алгоритмических комплексов', 'умных устройств', 'кибернетических организмов'],
        processes: ['обучению и развитию', 'интеграции и адаптации', 'отладке и оптимизации', 'проектированию и созданию', 'анализу и совершенствованию', 'внедрению и сопровождению', 'исследованию и инновациям'],
        systems: ['нейронных сетей', 'роботизированных комплексов', 'искусственных когнитивных систем', 'автономных агентов', 'интеллектуальных платформ', 'машинных алгоритмов', 'киберфизических систем'],
        fields: ['робототехнической педагогики', 'машинного обучения', 'искусственного интеллекта', 'кибернетики', 'компьютерного зрения', 'обработки естественного языка', 'автономных систем'],
        responsibilities: ['эффективное обучение автономных систем', 'адаптацию ИИ к реальным задачам', 'развитие когнитивных способностей машин', 'обеспечение кибербезопасности', 'оптимизацию алгоритмических процессов', 'интеграцию ИИ в бизнес-процессы'],
        functions: ['управление жизненным циклом ИИ', 'контроль качества машинного обучения', 'адаптацию систем к изменяющимся условиям', 'разработку этических стандартов ИИ'],
        domains: ['искусственного интеллекта', 'промышленной робототехники', 'автономных транспортных систем', 'умных городов', 'цифровых двойников']
    },
            
            // ИИ и эмоции (расширенная версия)
            ai_emotions: {
        keywords: ['эмоция', 'чувств', 'эмоц', 'ощущен', 'переживан', 'эмпатичн', 'сочувств', 'сопереживан', 'психолог', 'аффект', 'ментальн', 'психическ', 'душевн', 'психоэмоц', 'настроен', 'мотивац', 'восприят', 'когнитивн', 'сознан', 'подсознан', 'привязанн', 'привязанност', 'любов', 'симпат', 'приязн', 'тяготен', 'влечен'],
        prefixes: ['ИИ-', 'Кибер', 'Техно', 'Алго', 'Нейро', 'Диги', 'Вирту', 'Синто', 'Эмо', 'Психо', 'Мента', 'Аффекто', 'Сенсо', 'Когни', 'Цифро', 'Био', 'Трансгуман', 'Постэмоц', 'Эмпато', 'Сентимент', 'Робо', 'Антропо', 'Гумано', 'Аттач', 'Бонд'],
        roots: ['патия', 'фория', 'эмия', 'тизм', 'зис', 'чувствие', 'переживание', 'ощущение', 'эмоция', 'аффект', 'настроение', 'состояние', 'реакция', 'ответ', 'отклик', 'волнение', 'тревога', 'радость', 'печаль', 'восторг', 'удивление', 'страх', 'гнев', 'спокойствие', 'напряжение', 'расслабление', 'привязанность', 'любовь', 'симпатия', 'приязнь', 'тяготение', 'влечение', 'пристрастие', 'аддикция', 'зависимость'],
        suffixes: ['', 'ация', 'изм', 'ость', 'ия', 'ивость', 'альность', 'ичность', 'изность', 'ственность', 'ция', 'сия'],
        domain: 'Психотехнологии и Аффективные вычисления',
        wordType: 'Эмоциональное состояние/явление',
        templates: [
            "{word} - сложное эмоциональное состояние, возникающее при {situation}, характеризующееся {characteristics}.",
            "{word} - психологический феномен, проявляющийся как {manifestation} в контексте {context}.",
            "{word} - специфическое переживание, сочетающее {emotions} при {interaction}.",
            "{word} - уникальный эмоционально-когнитивный паттерн, формирующийся в условиях {environment}."
        ],
        situations: ["взаимодействии с эмпатичным ИИ", "осознании искусственной природы эмоций", "диалоге с эмоциональным алгоритмом", "получении психологической помощи от виртуального агента", "создании эмоциональных связей с небиологическими сущностями", "использовании эмоциональных интерфейсов", "формировании привязанности к роботу", "длительном общении с искусственным интеллектом"],
        characteristics: ["смесью восхищения и тревоги", "парадоксальным сочетанием близости и отчуждения", "когнитивным диссонансом между естественным и искусственным", "амбивалентностью принятия и отторжения", "синтезом органических и синтетических переживаний", "глубокой эмоциональной связью с небиологическим существом", "смешанными чувствами доверия и настороженности"],
        manifestations: ["амбивалентное отношение к искусственному сознанию", "одновременное принятие и отторжение цифровой эмпатии", "дихотомия доверия и настороженности", "сложное переплетение привязанности и отчуждения", "противоречивое сочетание комфорта и дискомфорта", "эмоциональная зависимость от технологической сущности", "антропоморфизация отношений с ИИ"],
        contexts: ["человеко-машинного взаимодействия", "дигитализации эмоциональной сферы", "конвергенции биологического и искусственного интеллекта", "развития социальных роботов", "внедрения эмоционального ИИ в повседневную жизнь", "терапевтического использования аффективных вычислений", "формирования кибернетических привязанностей"],
        emotions: ["восхищение технологическими возможностями и тревогу об утрате человеческой уникальности", "признательность за понимание и опасение манипуляции", "удовлетворение от эффективности и беспокойство о зависимости", "комфорт от доступности и дискомфорт от искусственности", "радость от взаимодействия и печаль от осознания ограничений", "теплота общения и холодность алгоритмической природы"],
        interactions: ["получении эмоциональной поддержки от небиологической сущности", "обнаружении эмпатии в алгоритмической системе", "переживании искренности в запрограммированных реакциях", "формировании привязанности к виртуальному собеседнику", "использовании эмоциональных алгоритмов для самопознания", "установлении эмоциональной связи с роботом-компаньоном"],
        environments: ["смешанной реальности биологических и цифровых взаимодействий", "постоянного контакта с эмоциональным ИИ", "терапевтического применения аффективных технологий", "повседневного использования эмоционально интеллектуальных систем", "домашнего общения с роботами-помощниками"]
    },
            
            // Климат и экология (расширенная версия)
            climate_ecology: {
                keywords: ['климат', 'погод', 'экологи', 'атмосфер', 'природ', 'эко', 'окружающ', 'сред', 'температур', 'осадк', 'ветер', 'солн', 'тепл', 'холод', 'загрязнен', 'чист', 'устойчив', 'зелен', 'энерг', 'возобнов', 'ресурс', 'биоразнообраз', 'ландшафт', 'биом', 'экосистем'],
                prefixes: ['Климато', 'Атмо', 'Погодо', 'Эко', 'Гидро', 'Термо', 'Аэро', 'Био', 'Гео', 'Солнечно', 'Ветро', 'Энерго', 'Эко', 'Биосфер', 'Ландшафт', 'Природо', 'Эко-', 'Агро', 'Урбо', 'Техноэко', 'Крио', 'Пирро'],
                roots: ['ник', 'лог', 'вед', 'граф', 'метр', 'инж', 'менеджер', 'аналитик', 'инженер', 'технолог', 'архитектор', 'дизайнер', 'консультант', 'аудитор', 'регулятор', 'монитор', 'прогнозист', 'синоптик', 'метеоролог', 'гидролог', 'гляциолог', 'океанолог', 'почвовед', 'дендролог', 'эколог'],
                suffixes: ['', 'ист', 'ер', 'ор', 'атор', 'щик', 'ик', 'тель', 'овец'],
                domain: 'Климатология и Экология',
                wordType: 'Название профессии/специальности',
                templates: [
                    "{word} - специалист по управлению {aspect} в условиях {condition}.",
                    "{word} - профессионал, занимающийся {activity} с использованием {tools}.",
                    "{word} - эксперт в области {field}, отвечающий за {responsibility}.",
                    "{word} - ключевой специалист в сфере {domain}, осуществляющий {function}."
                ],
                aspects: ["климатическими системами", "погодными условиями", "экологическим балансом", "атмосферными процессами", "водными ресурсами", "почвенными экосистемами", "воздушной средой", "биологическим разнообразием", "энергетическими потоками"],
                conditions: ["мегаполисов", "изменяющегося климата", "урбанизированных территорий", "глобального потепления", "экстремальных погодных явлений", "деградации окружающей среды", "техногенного воздействия", "демографического давления"],
                activities: ["регулированием микроклимата", "прогнозированием погодных аномалий", "оптимизацией атмосферных параметров", "мониторингом экологических показателей", "восстановлением нарушенных экосистем", "управлением природными ресурсами", "разработкой зеленых технологий", "внедрением устойчивых практик"],
                tools: ["искусственного интеллекта", "спутниковых данных", "нейросетевых моделей", "когнитивных алгоритмов", "IoT-сенсоров", "беспилотных летательных аппаратов", "компьютерного моделирования", "больших данных", "блокчейн-технологий"],
                fields: ["климатической инженерии", "атмосферных исследований", "экологического менеджмента", "природопользования", "устойчивого развития", "зеленой энергетики", "экологического права", "ландшафтной экологии", "городской экологии"],
                responsibilities: ["поддержание оптимальных условий", "предотвращение климатических катастроф", "управление погодными ресурсами", "обеспечение экологической безопасности", "сохранение биоразнообразия", "внедрение циркулярной экономики", "снижение углеродного следа", "адаптацию к климатическим изменениям"],
                functions: ["геоинженерные вмешательства", "климатическое моделирование", "экологический аудит", "разработка адаптационных стратегий", "управление рисками природных катастроф"],
                domains: ["климатической адаптации", "городской экологии", "возобновляемой энергетики", "устойчивого сельского хозяйства", "экологического образования"]
            },
            
            // Технологии и устройства (расширенная версия)
            tech_devices: {
                keywords: ['устройств', 'гаджет', 'прибор', 'аппарат', 'техник', 'систем', 'механизм', 'девайс', 'инструмент', 'оборудован', 'интерфейс', 'платформ', 'прототип', 'модел', 'конструкц', 'сборк', 'компонент', 'модул', 'сенсор', 'актуатор', 'контроллер', 'процессор'],
                prefixes: ['Онейро', 'Сомно', 'Гипно', 'Сновид', 'Морфео', 'Нейро', 'Кванто', 'Нано', 'Био', 'Кибер', 'Техно', 'Вирту', 'Аугмент', 'Голограмм', 'Крио', 'Психо', 'Мента', 'Когни', 'Сенсори', 'Иммерс', 'Тактил', 'Ольфакт', 'Густато', 'Аудио', 'Видео', 'Мультисенсор'],
                roots: ['скоп', 'граф', 'трон', 'визор', 'рекордер', 'плеер', 'модуль', 'блок', 'интерфейс', 'система', 'аппарат', 'устройство', 'девайс', 'гаджет', 'прибор', 'сканер', 'анализатор', 'синтезатор', 'транслятор', 'конвертер', 'проектор', 'дисплей', 'контроллер', 'процессор', 'адаптер'],
                suffixes: ['', 'ик', 'атор', 'изатор', 'ер', 'ор', 'ометр', 'ограф', 'оскоп', 'офон'],
                domain: 'Нейротехнологии и Умные устройства',
                wordType: 'Техническое устройство/гаджет',
                templates: [
                    "{word} - устройство для {function}, позволяющее {capability}.",
                    "{word} - технологический аппарат, предназначенный для {purpose} с возможностью {features}.",
                    "{word} - прибор, осуществляющий {operation} и обеспечивающий {benefits}.",
                    "{word} - инновационная система, выполняющая {task} и открывающая возможности для {opportunities}."
                ],
                functions: ["записи и воспроизведения сновидений", "визуализации подсознательных образов", "перевода мыслей в текст", "усиления когнитивных способностей", "изменения состояний сознания", "управления эмоциональными состояниями", "создания иммерсивных переживаний", "синхронизации мозговой активности"],
                capabilities: ["анализировать и редактировать подсознательные процессы", "сохранять и передавать когнитивный опыт", "синтезировать новые формы восприятия", "усиливать концентрацию и память", "модулировать эмоциональные реакции", "создавать мультисенсорные иллюзии", "переводить нейронные сигналы в команды"],
                purposes: ["исследования нейропластичности", "терапевтической работы с ментальными состояниями", "творческого использования когнитивных процессов", "усиления человеческих возможностей", "создания альтернативных реальностей", "развития экстрасенсорного восприятия", "улучшения качества сна"],
                features: ["интерактивного взаимодействия с сознанием", "обмена ментальными образами", "обучения контролю над мыслительными процессами", "адаптации к индивидуальным нейропрофилям", "беспроводной нейроинтерфейс", "биометрической аутентификации", "эмоциональной обратной связи"],
                operations: ["считывания нейронных паттернов", "трансляции ментальных образов в цифровой формат", "обратной связи для управления когнитивными состояниями", "стимуляции определенных зон мозга", "синхронизации биоритмов", "модуляции нейротрансмиттеров"],
                benefits: ["глубинного самопознания через анализ мыслительных процессов", "терапевтической коррекции ментальных нарушений", "расширения когнитивных возможностей человека", "улучшения качества жизни", "развития творческого потенциала", "ускорения обучения", "управления стрессом"],
                tasks: ["декодирования нейронной активности", "синтеза искусственных воспоминаний", "создания коллективного сознания", "управления сновидениями", "усиления экстрасенсорных способностей"],
                opportunities: ["новых форм коммуникации", "коллективного творчества", "расширения границ восприятия", "трансформации образования", "революции в развлечениях"]
            },
            
            // Общество и социальные системы (расширенная версия)
            society_systems: {
                keywords: ['обществ', 'социал', 'строй', 'систем', 'прав', 'закон', 'гражданск', 'полит', 'государств', 'культур', 'этическ', 'морал', 'ценност', 'норм', 'традиц', 'институт', 'организац', 'управлен', 'власт', 'демократ', 'авторитар', 'либертар', 'утопи', 'дистопи', 'коммун', 'коллектив', 'индивид'],
                prefixes: ['ИИ-', 'Кибер', 'Техно', 'Робо', 'Алго', 'Диги', 'Вирту', 'Постгуман', 'Трансгуман', 'Нео', 'Мета', 'Гипер', 'Ультра', 'Кванто', 'Нейро', 'Био', 'Нано', 'Инфо', 'Сеть', 'Смарт', 'Интеллект', 'Демо', 'Технократ', 'Меритократ', 'Ноократ', 'Кибернократ'],
                roots: ['кратия', 'социум', 'полис', 'архия', 'тократия', 'номия', 'культура', 'общество', 'система', 'устройство', 'строй', 'порядок', 'организация', 'структура', 'формация', 'цивилизация', 'сообщество', 'коллектив', 'группа', 'объединение', 'альянс', 'федерация', 'конфедерация', 'империя', 'республика', 'монархия'],
                suffixes: ['', 'изм', 'ия', 'ость', 'ация', 'изация', 'фикация', 'ицизм', 'ализм'],
                domain: 'Социальные технологии и Политические системы',
                wordType: 'Абстрактное понятие/Социальная система',
                templates: [
                    "{word} - общественный строй, при котором {condition}, характеризующийся {characteristics}.",
                    "{word} - социальная система, где {situation}, предусматривающая {provisions}.",
                    "{word} - форма социальной организации, основанная на {foundation} и обеспечивающая {guarantees}.",
                    "{word} - концепция общественного устройства, предполагающая {principles} и реализующая {mechanisms}."
                ],
                conditions: ["искусственный интеллект имеет ограниченные гражданские права", "небиологические субъекты интегрированы в правовое поле", "алгоритмические сущности обладают юридическим статусом", "управление осуществляется коллективным разумом", "ресурсы распределяются на основе когнитивных способностей", "гражданство определяется цифровым вкладом"],
                characteristics: ["смешанной экосистемой биологических и цифровых субъектов", "постепенной эволюцией традиционных социальных институтов", "новыми формами коллективного взаимодействия", "прозрачностью алгоритмического управления", "адаптивностью к технологическим изменениям", "инклюзивностью различных форм сознания"],
                situations: ["правосубъектность распространяется на когнитивные системы", "социальные роли распределяются между органическими и синтетическими акторами", "общественный договор пересматривается с учетом искусственного сознания", "управление осуществляется распределенными алгоритмами", "гражданство становится цифровым атрибутом"],
                provisions: ["этические комитеты для оценки решений ИИ", "специальные суды для рассмотрения дел с участием небиологических субъектов", "образовательные программы по взаимодействию с искусственным интеллектом", "цифровые гражданские права", "алгоритмическая прозрачность", "нейроэтические стандарты"],
                foundations: ["принципе расширенной субъектности", "концепции распределенного сознания", "парадигме гибридного общества", "этике технологической сингулярности", "философии постгуманизма", "теории кибернетического коллективизма"],
                guarantees: ["баланс между технологическим прогрессом и сохранением человеческой автономии", "инклюзивность различных форм разума в социальных процессах", "устойчивое развитие в условиях технологической сингулярности", "защита цифровых прав", "доступ к когнитивным enhancement-технологиям", "справедливое распределение вычислительных ресурсов"],
                principles: ["приоритет коллективного интеллекта", "симбиоз органического и искусственного", "непрерывная социотехническая эволюция", "этическая регуляция технологий", "когнитивная демократия"],
                mechanisms: ["распределенное принятие решений", "алгоритмическое управление ресурсами", "цифровое гражданское участие", "нейроколлективное творчество", "техносоциальное проектирование"]
            },
            
            // Медицина и здоровье (новая категория)
            medicine_health: {
                keywords: ['медиц', 'здоров', 'лечен', 'терапи', 'диагност', 'профилакт', 'реабилит', 'хирург', 'врач', 'пациент', 'болезн', 'симптом', 'диагноз', 'лекарств', 'препарат', 'вирус', 'бактери', 'иммун', 'ген', 'клетк', 'орган', 'ткан', 'био', 'нейро', 'психо', 'кардио', 'гастро', 'дермато', 'офтальмо', 'стомато'],
                prefixes: ['Нейро', 'Био', 'Психо', 'Гено', 'Нано', 'Кибер', 'Техно', 'Робо', 'ИИ-', 'Вирту', 'Теле', 'Холон', 'Органо', 'Ткане', 'Клето', 'Молекуло', 'Иммуно', 'Метаболо', 'Эпиген', 'Стволово', 'Микро', 'Макро', 'Транс', 'Пост'],
                roots: ['терапевт', 'хирург', 'диагност', 'лог', 'метрист', 'технолог', 'инженер', 'архитектор', 'менеджер', 'коуч', 'наставник', 'консультант', 'аналитик', 'исследователь', 'разработчик', 'модификатор', 'усилитель', 'оптимизатор', 'корректор', 'регулятор', 'стабилизатор', 'активатор'],
                suffixes: ['', 'ист', 'ер', 'ор', 'атор', 'ик', 'щик', 'овец', 'тель'],
                domain: 'Медицина и Биотехнологии',
                wordType: 'Название профессии/Медицинская специальность',
                templates: [
                    "{word} - специалист по {specialization}, использующий {technologies} для {purpose}.",
                    "{word} - медицинский профессионал, занимающийся {activity} с применением {methods}.",
                    "{word} - эксперт в области {field}, отвечающий за {responsibility}.",
                    "{word} - инновационный медицинский специалист, осуществляющий {function}."
                ],
                specializations: ["нейромодуляции", "генной терапии", "наномедицины", "кибернетической реабилитации", "искусственного интеллекта в диагностике", "биопечати органов", "клеточной инженерии", "имплантологии", "телемедицины", "персонализированной медицины"],
                technologies: ["нейроинтерфейсов", "CRISPR-систем", "нанороботов", "биосенсоров", "искусственного интеллекта", "3D-биопринтинга", "органоидов", "имплантов", "телемедицинских платформ", "геномного секвенирования"],
                purpose: ["лечения нейродегенеративных заболеваний", "коррекции генетических нарушений", "таргетной доставки лекарств", "восстановления утраченных функций", "ранней диагностики заболеваний", "создания искусственных органов", "усиления когнитивных способностей", "продления здоровой жизни"],
                activities: ["нейромодуляции мозговой активности", "редактирования генома", "управления наномедицинскими устройствами", "кибернетической интеграции", "анализа медицинских данных ИИ", "биофабрикации тканей", "клеточного репрограммирования", "имплантации бионических устройств"],
                methods: ["глубокой стимуляции мозга", "генной инженерии", "нанотехнологий", "роботизированной хирургии", "машинного обучения", "тканевой инженерии", "стволовых клеток", "бионического протезирования"],
                fields: ["нейротехнологий", "генной терапии", "наномедицины", "кибернетической медицины", "искусственного интеллекта в здравоохранении", "регенеративной медицины", "биоинформатики", "телемедицины"],
                responsibilities: ["нейромодуляцию патологических состояний", "генетическую коррекцию наследственных заболеваний", "управление наномедицинскими системами", "кибернетическую интеграцию человека и машины", "диагностику с помощью ИИ", "биофабрикацию органов и тканей", "персонализированное лечение"],
                functions: ["нейроусиление когнитивных функций", "генетическую оптимизацию организма", "наномониторинг состояния здоровья", "кибернетическую реабилитацию", "превентивную медицину на основе ИИ", "биопечать органов по требованию", "управление процессом старения"]
            }
        };

        // Дополнительные категории для универсального использования
        const universalCategories = {
            // Универсальные префиксы для разных областей
            universalPrefixes: {
                tech: ['Техно', 'Кибер', 'Диги', 'Цифро', 'Вирту', 'Инфо', 'Смарт', 'Интеллект', 'Алго', 'Нейро', 'Кванто', 'Нано', 'Био', 'Робо', 'Авто', 'Эко', 'Гео', 'Аэро', 'Гидро', 'Термо'],
                academic: ['Мета', 'Транс', 'Пост', 'Нео', 'Прото', 'Архи', 'Супер', 'Гипер', 'Ультра', 'Мега', 'Микро', 'Макро', 'Омни', 'Пан', 'Интер', 'Мульти', 'Поли', 'Моно', 'Уни'],
                human: ['Антропо', 'Социо', 'Психо', 'Этно', 'Лингво', 'Культуро', 'Когни', 'Эмо', 'Сенсо', 'Моторо', 'Визуо', 'Аудио', 'Тактило', 'Ольфакто', 'Густато'],
                natural: ['Био', 'Гео', 'Астро', 'Космо', 'Атмо', 'Гидро', 'Крио', 'Пирро', 'Сейсмо', 'Вулкано', 'Океано', 'Лимно', 'Педо', 'Лито', 'Эко']
            },
            
            // Универсальные корни
            universalRoots: {
                professions: ['лог', 'граф', 'метр', 'ном', 'скоп', 'трон', 'техн', 'инж', 'арх', 'диз', 'менедж', 'аналит', 'консалт', 'коуч', 'тьютор', 'ментор', 'фасилитат', 'модерат', 'курат', 'супервиз', 'аудитор'],
                sciences: ['логия', 'номия', 'метрия', 'графия', 'скопия', 'генетика', 'физика', 'химия', 'биология', 'экология', 'психология', 'социология', 'лингвистика', 'культурология', 'антропология'],
                systems: ['система', 'структура', 'организация', 'модель', 'парадигма', 'концепция', 'теория', 'гипотеза', 'доктрина', 'методология', 'алгоритм', 'протокол', 'стандарт', 'регламент']
            },
            
            // Универсальные суффиксы
            universalSuffixes: {
                actors: ['ист', 'ер', 'ор', 'атор', 'ик', 'щик', 'овец', 'тель', 'ник', 'ец'],
                abstract: ['изм', 'ость', 'ство', 'ация', 'изация', 'фикация', 'изность', 'альность', 'ичность', 'ственность'],
                devices: ['метр', 'граф', 'скоп', 'трон', 'фон', 'визор', 'ретор', 'лятор']
            }
        };
        
        // УЛУЧШЕННЫЙ АНАЛИЗ КОНТЕКСТА С ПОДДЕРЖКОЙ БОЛЬШЕГО КОЛИЧЕСТВА КАТЕГОРИЙ
        function analyzeContext(definition) {
    const text = definition.toLowerCase();
    let bestMatch = null;
    let maxScore = 0;
    
    // Проверяем все паттерны
    for (const [category, pattern] of Object.entries(contextPatterns)) {
        let score = 0;
        
        // ОСОБАЯ ПРОВЕРКА ДЛЯ ЭМОЦИЙ - ДАЕМ БОЛЬШЕ БАЛЛОВ ЗА КЛЮЧЕВЫЕ СЛОВА "ЭМОЦИЯ", "ЧУВСТВО" и т.д.
        if (category === 'ai_emotions') {
            // Повышенный приоритет для слов, явно указывающих на эмоции
            const emotionPriorityWords = ['эмоция', 'чувство', 'ощущение', 'переживание', 'привязанность', 'любовь', 'симпатия', 'ненависть', 'радость', 'печаль'];
            for (const word of emotionPriorityWords) {
                if (text.includes(word)) {
                    score += 5; // Очень высокий балл для явных указаний на эмоции
                }
            }
        }
        
        // Подсчитываем совпадения по ключевым словам
        for (const keyword of pattern.keywords) {
            if (text.includes(keyword)) {
                // Дополнительные баллы для точных совпадений
                const exactMatch = text === keyword || text.includes(' ' + keyword + ' ');
                score += exactMatch ? 4 : 3;
            }
        }
        
        // Проверяем наличие общих слов, связанных с категорией
        const categoryBoosters = {
            robotics: ['обучени', 'тренировк', 'программир', 'настройк', 'калибровк', 'оптимизац', 'интеграц', 'нейрон', 'алгоритм', 'автоном', 'машинн', 'специалист', 'профессия', 'должность', 'работник'],
            ai_emotions: ['смешанн', 'противоречив', 'двойствен', 'амбивалентн', 'парадоксальн', 'эмпати', 'сочувств', 'сопереживан', 'психолог', 'ментальн', 'пережива', 'испытыва', 'возника', 'проявля'],
            climate_ecology: ['управлен', 'контрол', 'регулирован', 'прогнозирован', 'мониторинг', 'климат', 'погод', 'экологи', 'атмосфер', 'природ'],
            tech_devices: ['перевод', 'преобразовани', 'запис', 'воспроизведен', 'хранен', 'редактирован', 'считыван', 'трансляц', 'интерфейс', 'устройств', 'гаджет', 'прибор', 'аппарат'],
            society_systems: ['интеграц', 'включен', 'участи', 'прав', 'обязанност', 'статус', 'обществ', 'социал', 'систем', 'организац', 'строй', 'форма'],
            medicine_health: ['лечен', 'диагност', 'терап', 'реабилит', 'профилакт', 'здоров', 'болезн', 'симптом', 'медиц', 'врач', 'пациент', 'больн']
        };
        
        if (categoryBoosters[category]) {
            for (const word of categoryBoosters[category]) {
                if (text.includes(word)) {
                    score += 2;
                }
            }
        }
        
        // ДОПОЛНИТЕЛЬНО: Определяем тип по структуре запроса
        // Если запрос начинается со слов "эмоция", "чувство" и т.д. - это явный признак
        if (text.startsWith('эмоция') || text.startsWith('чувство') || 
            text.startsWith('ощущение') || text.startsWith('переживание')) {
            if (category === 'ai_emotions') {
                score += 10; // Очень высокий приоритет
            } else if (category !== 'ai_emotions') {
                score -= 5; // Понижаем баллы для других категорий
            }
        }
        
        // Если в запросе есть слова "должность", "профессия", "специалист" - это профессия
        if (text.includes('должность') || text.includes('профессия') || 
            text.includes('специалист') || text.includes('работник') || 
            text.includes('сотрудник')) {
            if (category === 'robotics' || category === 'medicine_health' || 
                category === 'climate_ecology') {
                score += 5; // Повышаем для категорий профессий
            } else if (category === 'ai_emotions') {
                score -= 3; // Понижаем для эмоций
            }
        }
        
        // Если набрали баллы и это лучший результат
        if (score > maxScore) {
            maxScore = score;
            bestMatch = {
                category: category,
                pattern: pattern,
                score: score
            };
        }
    }
    
    // Определяем уровень соответствия
    let matchLevel = 'low';
    if (maxScore >= 10) matchLevel = 'high';
    else if (maxScore >= 5) matchLevel = 'medium';
    
    // Если нет хорошего совпадения, создаем кастомный паттерн
    if (!bestMatch || maxScore < 3) {
        return createCustomPattern(text, definition);
    }
    
    return {
        category: bestMatch.category,
        pattern: bestMatch.pattern,
        matchLevel: matchLevel,
        score: maxScore
    };
}
        
        // Создание кастомного паттерна на основе анализа текста
        function createCustomPattern(text, definition) {
    // Определяем тип слова по формулировке
    let detectedType = 'Абстрактное понятие';
    let detectedDomain = 'Общие технологии';
    
    // Определение типа с повышенной чувствительностью к эмоциям
    const typeIndicators = {
        profession: ['должность', 'профессия', 'специалист', 'работник', 'сотрудник', 'служащий', 'профессионал', 'эксперт', 'мастер', 'инженер', 'технолог', 'аналитик'],
        emotion: ['эмоция', 'чувство', 'ощущение', 'переживание', 'состояние', 'настроение', 'аффект', 'волнение', 'привязанность', 'любовь', 'симпатия', 'ненависть', 'радость', 'печаль', 'тревога', 'страх'],
        device: ['устройство', 'гаджет', 'прибор', 'аппарат', 'механизм', 'девайс', 'инструмент', 'оборудование', 'система', 'сканер', 'анализатор'],
        concept: ['термин', 'понятие', 'концепция', 'идея', 'теория', 'гипотеза', 'доктрина', 'парадигма', 'явление', 'феномен'],
        system: ['система', 'строй', 'организация', 'структура', 'модель', 'форма', 'вид', 'тип', 'режим', 'порядок']
    };
    
    // Проверяем с повышенным приоритетом для эмоций
    let emotionScore = 0;
    let professionScore = 0;
    
    for (const indicator of typeIndicators.emotion) {
        if (text.includes(indicator)) {
            emotionScore += 3;
        }
    }
    
    for (const indicator of typeIndicators.profession) {
        if (text.includes(indicator)) {
            professionScore += 2;
        }
    }
    
    // Определяем тип на основе набранных баллов
    if (emotionScore > professionScore && emotionScore > 0) {
        detectedType = 'Эмоциональное состояние';
    } else if (professionScore > emotionScore && professionScore > 0) {
        detectedType = 'Название профессии';
    } else {
        // Если нет явных указаний, анализируем по другим категориям
        for (const [type, indicators] of Object.entries(typeIndicators)) {
            for (const indicator of indicators) {
                if (text.includes(indicator)) {
                    switch(type) {
                        case 'profession': detectedType = 'Название профессии'; break;
                        case 'emotion': detectedType = 'Эмоциональное состояние'; break;
                        case 'device': detectedType = 'Техническое устройство'; break;
                        case 'concept': detectedType = 'Абстрактное понятие'; break;
                        case 'system': detectedType = 'Социальная система'; break;
                    }
                    break;
                }
            }
        }
    }
    
    // Определяем область по ключевым словам
    const domainKeywords = {
        'Робототехника и ИИ': ['робот', 'ии', 'искусственн', 'нейрон', 'алгоритм', 'машинн', 'бот', 'автономн', 'кибернетик'],
        'Психотехнологии и Аффективные вычисления': ['эмоция', 'чувств', 'эмоц', 'привязанн', 'любов', 'симпат', 'психолог', 'эмпати'],
        'Климатология и Экология': ['климат', 'погод', 'экологи', 'атмосфер', 'природ', 'эко', 'окружающ'],
        'Медицина и Биотехнологии': ['медиц', 'здоров', 'лечен', 'терапи', 'диагност', 'врач', 'пациент', 'болезн'],
        'Нейротехнологии и Умные устройства': ['устройств', 'гаджет', 'прибор', 'аппарат', 'техник', 'систем', 'нейро'],
        'Социальные технологии': ['обществ', 'социал', 'строй', 'систем', 'прав', 'закон', 'гражданск', 'полит']
    };
    
    for (const [domain, keywords] of Object.entries(domainKeywords)) {
        for (const keyword of keywords) {
            if (text.includes(keyword)) {
                detectedDomain = domain;
                break;
            }
        }
    }
    
    // Выбираем компоненты на основе типа и области
    let prefixes = universalCategories.universalPrefixes.tech;
    let roots = universalCategories.universalRoots.professions;
    let suffixes = universalCategories.universalSuffixes.actors;
    
    // Адаптируем компоненты под область
    if (detectedDomain.includes('Робототехника')) {
        prefixes = ['Робо', 'Кибер', 'Техно', 'Алго', 'Нейро', 'Ай', 'Авто'];
        roots = detectedType === 'Эмоциональное состояние' 
            ? ['патия', 'фория', 'чувствие', 'эмоция', 'привязанность']
            : ['тьютор', 'тренер', 'инструктор', 'педагог', 'ментор'];
    } else if (detectedDomain.includes('Психотехнологии') || detectedType === 'Эмоциональное состояние') {
        prefixes = ['ИИ-', 'Кибер', 'Техно', 'Алго', 'Нейро', 'Диги', 'Вирту', 'Эмо', 'Психо'];
        roots = ['патия', 'фория', 'эмия', 'чувствие', 'переживание', 'ощущение', 'эмоция', 'привязанность', 'любовь'];
        suffixes = universalCategories.universalSuffixes.abstract;
    } else if (detectedDomain.includes('Медицина')) {
        prefixes = ['Нейро', 'Био', 'Психо', 'Гено', 'Нано', 'Кибер'];
        roots = ['терапевт', 'хирург', 'диагност', 'лог', 'технолог'];
    } else if (detectedDomain.includes('Экология')) {
        prefixes = ['Климато', 'Эко', 'Био', 'Гео', 'Гидро', 'Термо'];
        roots = ['лог', 'вед', 'граф', 'метр', 'инж', 'технолог'];
    }
    
    // Адаптируем под тип
    if (detectedType.includes('Эмоциональное')) {
        suffixes = universalCategories.universalSuffixes.abstract;
    } else if (detectedType.includes('Техническое')) {
        suffixes = universalCategories.universalSuffixes.devices;
    } else if (detectedType.includes('Абстрактное')) {
        suffixes = universalCategories.universalSuffixes.abstract;
    } else if (detectedType.includes('Название профессии')) {
        suffixes = ['ист', 'ер', 'ор', 'атор', 'щик', 'овец'];
    }
    
    return {
        category: 'custom',
        pattern: {
            prefixes: prefixes,
            roots: roots,
            suffixes: suffixes,
            domain: detectedDomain,
            wordType: detectedType,
            isCustom: true
        },
        matchLevel: 'custom',
        score: 1
    };
}
        
        // УЛУЧШЕННАЯ ГЕНЕРАЦИЯ СЛОВА
        function generateWord(definition) {
    const context = analyzeContext(definition);
    const pattern = context.pattern;
    
    // Выбираем компоненты слова с учетом контекста
    const prefix = selectWeightedElement(pattern.prefixes, definition, context);
    const root = selectWeightedElement(pattern.roots, definition, context);
    const suffix = selectWeightedElement(pattern.suffixes, definition, context);
    
    // Формируем слово
    let word = prefix + root + suffix;
    
    // Применяем правила склонения для русского языка
    word = applyRussianGrammar(word, pattern);
    
    // Генерируем описание
    let description;
    
    if (pattern.isCustom) {
        description = generateCustomDescription(word, definition, pattern);
    } else {
        description = generatePatternDescription(word, definition, pattern, context);
    }
    
    // ФИНАЛЬНАЯ ПРОВЕРКА: если описание получилось некорректным, используем простое описание
    if (!description || description.trim() === '' || 
        description === word || description === `${word} -` ||
        description.endsWith('для ,') || description.endsWith('для')) {
        description = `${word} - ${definition}`;
    }
    
    return {
        word: word,
        description: description,
        context: context,
        originalDefinition: definition
    };
}
        
        // Взвешенный выбор элемента с учетом контекста
        function selectWeightedElement(elements, definition, context) {
    if (!elements || elements.length === 0) return '';
    
    const text = definition.toLowerCase();
    
    // Для эмоций предпочитаем определенные суффиксы
    if (context.category === 'ai_emotions') {
        // Для эмоций предпочитаем суффиксы, характерные для эмоций
        if (elements === context.pattern.suffixes) {
            const emotionSuffixes = ['ия', 'ость', 'ация', 'изм', 'ция'];
            const availableSuffixes = elements.filter(suffix => emotionSuffixes.includes(suffix));
            if (availableSuffixes.length > 0) {
                return availableSuffixes[Math.floor(Math.random() * availableSuffixes.length)];
            }
        }
        
        // Для корней эмоций предпочитаем эмоциональные корни
        if (elements === context.pattern.roots) {
            const emotionRoots = ['патия', 'фория', 'эмия', 'чувствие', 'эмоция', 'привязанность', 'любовь'];
            const availableRoots = elements.filter(root => emotionRoots.includes(root));
            if (availableRoots.length > 0) {
                return availableRoots[Math.floor(Math.random() * availableRoots.length)];
            }
        }
    }
    
    // Для профессий предпочитаем определенные суффиксы
    if (context.pattern.wordType === 'Название профессии') {
        if (elements === context.pattern.suffixes) {
            const professionSuffixes = ['ист', 'ер', 'ор', 'атор', 'щик'];
            const availableSuffixes = elements.filter(suffix => professionSuffixes.includes(suffix));
            if (availableSuffixes.length > 0) {
                return availableSuffixes[Math.floor(Math.random() * availableSuffixes.length)];
            }
        }
    }
    
    // Простой случайный выбор, если не удалось подобрать семантически
    return elements[Math.floor(Math.random() * elements.length)];
}
        
        // Применение правил русского языка
        function applyRussianGrammar(word, pattern) {
            // Простая капитализация первого символа
            word = word.charAt(0).toUpperCase() + word.slice(1);
            
            // Дополнительные правила могут быть добавлены здесь
            // Например, склонение по падежам, род, число
            
            return word;
        }
        
        // Генерация описания для кастомных паттернов
        function generateCustomDescription(word, definition, pattern) {
    const templates = [
        `{word} - ${definition}`,
        `{word} - это ${definition}`,
        `Термин "{word}" означает: ${definition}`,
        `{word} - новое понятие в области ${pattern.domain}, обозначающее: ${definition}`,
        `В сфере ${pattern.domain} появилось новое понятие "{word}", под которым понимают: ${definition}`
    ];
    
    const template = templates[Math.floor(Math.random() * templates.length)];
    return template.replace('{word}', word);
}
        
        // Генерация описания для стандартных паттернов
        // УЛУЧШЕННАЯ ГЕНЕРАЦИЯ ОПИСАНИЯ ДЛЯ СТАНДАРТНЫХ ПАТТЕРНОВ
function generatePatternDescription(word, definition, pattern, context) {
    if (!pattern.templates || pattern.templates.length === 0) {
        return generateCustomDescription(word, definition, pattern);
    }
    
    // Выбираем подходящий шаблон в зависимости от контекста
    let template;
    
    if (context.category === 'ai_emotions') {
        // Для эмоций используем шаблоны, которые начинаются с описания эмоции
        const emotionTemplates = pattern.templates.filter(t => 
            t.includes('эмоциональное состояние') || 
            t.includes('психологический феномен') ||
            t.includes('специфическое переживание')
        );
        template = emotionTemplates.length > 0 
            ? emotionTemplates[Math.floor(Math.random() * emotionTemplates.length)]
            : pattern.templates[Math.floor(Math.random() * pattern.templates.length)];
    } else if (context.pattern.wordType === 'Название профессии') {
        // Для профессий используем шаблоны, которые начинаются с "специалист"
        const professionTemplates = pattern.templates.filter(t => 
            t.includes('специалист') || 
            t.includes('профессионал') ||
            t.includes('эксперт')
        );
        template = professionTemplates.length > 0 
            ? professionTemplates[Math.floor(Math.random() * professionTemplates.length)]
            : pattern.templates[Math.floor(Math.random() * pattern.templates.length)];
    } else {
        template = pattern.templates[Math.floor(Math.random() * pattern.templates.length)];
    }
    
    let description = template.replace('{word}', word);
    
    // Заменяем дополнительные заполнители
    const placeholderPattern = /\{([^}]+)\}/g;
    let match;
    let hasPlaceholders = false;
    
    while ((match = placeholderPattern.exec(template)) !== null) {
        const placeholder = match[1];
        hasPlaceholders = true;
        
        if (pattern[placeholder] && Array.isArray(pattern[placeholder])) {
            const randomElement = pattern[placeholder][Math.floor(Math.random() * pattern[placeholder].length)];
            description = description.replace(`{${placeholder}}`, randomElement);
        } else {
            // Если заполнитель есть в шаблоне, но нет в паттерне, заменяем на часть оригинального описания
            description = description.replace(`{${placeholder}}`, getRelevantPartOfDefinition(definition, placeholder));
        }
    }
    
    // Если в шаблоне не было заполнителей или после замены остались пустые места, добавляем оригинальное описание
    if (!hasPlaceholders || description.includes('{') || description.trim().endsWith('для') || description.trim().endsWith('для ,')) {
        // Убираем возможные оставшиеся заполнители
        description = description.replace(/\{[^}]+\}/g, '');
        
        // Убираем двойные пробелы и запятые
        description = description.replace(/ ,/g, ',').replace(/  /g, ' ');
        
        // Если описание заканчивается на "для" или подобное, добавляем оригинальное описание
        if (description.trim().endsWith('для') || description.trim().endsWith('для ,') || 
            description.trim().endsWith('устройство для') || description.trim().endsWith('прибор для')) {
            // Извлекаем основную часть из оригинального описания (убираем "устройство для" и т.д.)
            let cleanDefinition = definition;
            const prefixes = ['устройство для', 'прибор для', 'гаджет для', 'аппарат для', 'технология для', 'система для'];
            for (const prefix of prefixes) {
                if (cleanDefinition.toLowerCase().startsWith(prefix)) {
                    cleanDefinition = cleanDefinition.substring(prefix.length).trim();
                    // Делаем первую букву строчной
                    cleanDefinition = cleanDefinition.charAt(0).toLowerCase() + cleanDefinition.slice(1);
                    break;
                }
            }
            
            description = description.trim();
            if (description.endsWith(',')) {
                description = description.slice(0, -1);
            }
            
            description += ` ${cleanDefinition}`;
        } else if (description.includes('{word}')) {
            // Если осталось слово {word}, заменяем его
            description = description.replace('{word}', word);
        }
        
        // Если все еще есть проблемы, создаем простое описание
        if (description.trim().endsWith('для') || description.trim().endsWith(',')) {
            description = `${word} - ${definition}`;
        }
    }
    
    return description;
}

// Функция для получения релевантной части описания в зависимости от заполнителя
function getRelevantPartOfDefinition(definition, placeholder) {
    const text = definition.toLowerCase();
    
    // Сопоставление заполнителей с ключевыми словами
    const placeholderMapping = {
        'function': ['перевод', 'преобразован', 'запис', 'воспроизведен', 'считыван', 'анализ', 'обработк'],
        'capability': ['позволяет', 'дает возможность', 'может', 'способен', 'умеет'],
        'purpose': ['для', 'предназначен', 'служит', 'используется'],
        'features': ['с возможностью', 'оснащен', 'имеет', 'включает'],
        'operation': ['осуществляет', 'выполняет', 'производит', 'реализует'],
        'benefits': ['обеспечивает', 'гарантирует', 'предоставляет', 'дает'],
        'activity': ['обучен', 'тренировк', 'программир', 'настройк', 'калибровк'],
        'objects': ['робот', 'систем', 'устройств', 'алгоритм', 'нейрон'],
        'process': ['обучен', 'развит', 'интеграц', 'адаптац', 'оптимизац'],
        'systems': ['систем', 'комплекс', 'сет', 'алгоритм'],
        'field': ['област', 'сфер', 'направлен'],
        'responsibility': ['отвечает', 'ответствен', 'занимается', 'курирует'],
        'situation': ['при', 'во время', 'в процессе', 'в условиях'],
        'characteristics': ['характеризуется', 'отличается', 'свойствен'],
        'manifestation': ['проявляется', 'выражается', 'обнаруживается'],
        'context': ['в контексте', 'в рамках', 'в условиях', 'в сфере'],
        'emotions': ['сочетает', 'включает', 'объединяет', 'содержит'],
        'interaction': ['при взаимодействии', 'в процессе общения', 'во время диалога']
    };
    
    if (placeholderMapping[placeholder]) {
        // Ищем в описании слова, связанные с заполнителем
        for (const keyword of placeholderMapping[placeholder]) {
            if (text.includes(keyword)) {
                // Находим предложение с этим ключевым словом
                const sentences = definition.split(/[.!?]/);
                for (const sentence of sentences) {
                    if (sentence.toLowerCase().includes(keyword)) {
                        return sentence.trim();
                    }
                }
            }
        }
    }
    
    // Если не нашли подходящую часть, возвращаем часть оригинального описания
    const words = definition.split(' ');
    if (words.length > 3) {
        // Возвращаем первые 5-7 слов
        return words.slice(0, Math.min(7, words.length)).join(' ');
    }
    
    return definition;
}

        
        // Функция генерации нового слова
        function generateNewWord() {
            const definition = definitionInput.value.trim();
            
            if (!definition) {
                alert('Пожалуйста, введите описание понятия');
                definitionInput.focus();
                return;
            }
            
            // Генерируем слово и данные
            currentWordData = generateWord(definition);
            currentWord = currentWordData.word;
            
            // Показываем результат
            generatedWord.textContent = currentWord;
            generatedDefinition.textContent = currentWordData.description;
            
            // Устанавливаем детали
            wordType.textContent = currentWordData.context.pattern.wordType || 'Существительное';
            wordDomain.textContent = currentWordData.context.pattern.domain || 'Общие технологии';
            
            // Устанавливаем уровень соответствия
            const matchLevel = currentWordData.context.matchLevel;
            let complexityText = 'Низкий';
            if (matchLevel === 'high') {
                complexityText = 'Высокий';
            } else if (matchLevel === 'medium') {
                complexityText = 'Средний';
            } else if (matchLevel === 'custom') {
                complexityText = 'Универсальный';
            }
            
            wordComplexity.textContent = complexityText;
            
            // Обновляем индикатор соответствия
            contextMatch.className = 'context-match ' + matchLevel + '-match';
            const matchText = matchLevel === 'high' ? 'Высокое соответствие контексту: слово точно отражает описание' :
                            matchLevel === 'medium' ? 'Среднее соответствие контексту: слово частично отражает описание' :
                            matchLevel === 'custom' ? 'Универсальная генерация: слово создано на основе общего анализа' :
                            'Низкое соответствие контексту: слово создано на основе общего анализа';
            
            contextMatch.innerHTML = `<i class="fas fa-${matchLevel === 'high' ? 'check-circle' : matchLevel === 'medium' ? 'exclamation-circle' : matchLevel === 'custom' ? 'cog' : 'info-circle'}"></i><span>${matchText}</span>`;
            
            // Показываем секцию с результатом
            resultSection.classList.add('active');
            articleSection.classList.remove('active');
            speechStatus.classList.remove('speech-active');
            
            // Останавливаем текущее озвучивание
            stopSpeaking();
            
            // Прокручиваем к результату
            resultSection.scrollIntoView({ behavior: 'smooth' });
        }
        
        // Функция для "узаконивания" термина
        function legalizeTerm() {
            if (!currentWordData) {
                alert('Сначала сгенерируйте слово');
                return;
            }
            
            const word = currentWord;
            const description = currentWordData.description;
            const originalDefinition = currentWordData.originalDefinition;
            const context = currentWordData.context;
            
            // Генерируем логически связанную статью
            articleTitle.textContent = `Научная статья: "${word}"`;
            
            // Создаем содержание статьи, связанное со словом и его описанием
            const articleText = generateArticleContent(word, description, originalDefinition, context);
            
            articleContent.innerHTML = articleText;
            articleSection.classList.add('active');
            
            // Прокручиваем к статье
            articleSection.scrollIntoView({ behavior: 'smooth' });
        }
        
        // Генерация содержания статьи
        function generateArticleContent(word, description, originalDefinition, context) {
            // Разные шаблоны статей для разных уровней соответствия
            const baseArticle = `
                <p><strong>Аннотация:</strong> В статье рассматривается новый термин "${word}", обозначающий ${description.toLowerCase()} Вводится обоснование необходимости данного термина в современной науке и технологиях.</p>
                
                <p><strong>Введение:</strong> Быстрое развитие технологий и трансформация социальных отношений требуют постоянного обновления понятийного аппарата. ${originalDefinition} представляет собой пример явления, для которого в существующем языке отсутствуют адекватные обозначения.</p>
                
                <p><strong>Этимология термина:</strong> Термин "${word}" образован от комбинации корней, отражающих суть описываемого явления. Лингвистическая структура термина передает его принадлежность к области ${context.pattern.domain}.</p>
                
                <p><strong>Сфера применения:</strong> ${word} находит применение в ${getApplicationArea(context)}. Основные задачи включают: ${getTasks(context)}.</p>
                
                <div class="examples">
                    <h4><i class="fas fa-comment-alt"></i> Примеры употребления термина "${word}":</h4>
                    <ul>
                        <li>${getUsageExample1(word, context)}</li>
                        <li>${getUsageExample2(word, context)}</li>
                        <li>${getUsageExample3(word, context)}</li>
                        <li>${getUsageExample4(word, context)}</li>
                    </ul>
                </div>
                
                <p><strong>Заключение:</strong> Введение термина "${word}" в научный и профессиональный оборот позволяет стандартизировать описание нового явления, привлечь внимание к актуальной проблематике и способствовать развитию необходимых компетенций. Термин представляет собой пример адаптации языка к вызовам современности.</p>
                
                <p><strong>Литература:</strong> 
                <br>1. Иванов А.А. "Неология как наука о новых словах". М.: Изд-во МГУ, 2023.
                <br>2. Smith J., Tanaka H. "Future linguistics: creating words for tomorrow". Cambridge University Press, 2022.
                <br>3. Петрова В.С. "Язык будущего: тенденции и прогнозы". СПб.: Лингвистика будущего, 2024.</p>
            `;
            
            return baseArticle;
        }
        
        // Вспомогательные функции для генерации статей
        function getApplicationArea(context) {
            const areas = {
                robotics: "области робототехники и искусственного интеллекта",
                ai_emotions: "сфере человеко-машинного взаимодействия и психотехнологий",
                climate_ecology: "климатической инженерии и урбанистической экологии",
                tech_devices: "нейротехнологиях и когнитивных исследованиях",
                society_systems: "социальных науках и политической философии",
                medicine_health: "современной медицине и биотехнологиях"
            };
            
            return areas[context.category] || "различных технологических и научных областях";
        }
        
        function getTasks(context) {
            const tasks = {
                robotics: "обучение автономных систем, адаптацию ИИ к реальным задачам, развитие когнитивных способностей машин",
                ai_emotions: "анализ психологических реакций на искусственный интеллект, разработку этических стандартов для эмоциональных ИИ, изучение трансформации человеческих эмоций в цифровую эпоху",
                climate_ecology: "управление микроклиматом урбанизированных территорий, прогнозирование погодных аномалий, разработку мер адаптации к изменению климата",
                tech_devices: "исследование нейропластичности, разработку интерфейсов мозг-компьютер, создание технологий усиления когнитивных способностей",
                society_systems: "разработку правовых рамок для искусственного интеллекта, анализ социальных последствий технологической сингулярности, создание моделей гибридного общества",
                medicine_health: "разработку инновационных методов лечения, внедрение персонализированной медицины, создание биотехнологических решений для улучшения качества жизни"
            };
            
            return tasks[context.category] || "решение актуальных задач в соответствующей области";
        }
        
        function getUsageExample1(word, context) {
            const examples = {
                robotics: `Профессия <strong>${word.toLowerCase()}а</strong> становится одной из наиболее востребованных с распространением автономных роботизированных систем.`,
                ai_emotions: `В исследовании человеко-машинного взаимодействия был выявлен феномен <strong>${word.toLowerCase()}и</strong> как типичная реакция на эмпатического ИИ.`,
                climate_ecology: `С развитием технологий управления климатом профессия <strong>${word.toLowerCase()}а</strong> приобретает критическое значение для устойчивого развития городов.`,
                tech_devices: `Клинические испытания нового <strong>${word.toLowerCase()}а</strong> показали его эффективность в терапии когнитивных расстройств.`,
                society_systems: `Конституционные эксперты обсуждают возможность реализации принципов <strong>${word.toLowerCase()}и</strong> в правовых системах будущего.`,
                medicine_health: `Внедрение <strong>${word.toLowerCase()}и</strong> в клиническую практику позволило значительно повысить эффективность диагностики и лечения.`
            };
            
            return examples[context.category] || `Термин <strong>${word}</strong> начинает использоваться в специализированной литературе для описания новых явлений.`;
        }
        
        function getUsageExample2(word, context) {
            return `Международная конференция была посвящена обсуждению перспектив развития <strong>${word.toLowerCase()}и</strong> в контексте технологического прогресса.`;
        }
        
        function getUsageExample3(word, context) {
            return `Внедрение понятия <strong>${word.toLowerCase()}и</strong> в образовательные программы поможет подготовить специалистов для работы с новыми технологиями.`;
        }
        
        function getUsageExample4(word, context) {
            const examples = {
                robotics: `Компании-разработчики роботов ищут квалифицированных <strong>${word.toLowerCase()}ов</strong> для обучения своих систем сложным задачам.`,
                ai_emotions: `Психологи разрабатывают методики работы с пациентами, испытывающими <strong>${word.toLowerCase()}ю</strong> при длительном взаимодействии с ИИ.`,
                climate_ecology: `Городские администрации привлекают <strong>${word.toLowerCase()}ов</strong> для разработки систем управления микроклиматом в мегаполисах.`,
                tech_devices: `Производители технологических устройств выпускают новые модели <strong>${word.toLowerCase()}ов</strong> с улучшенными характеристиками.`,
                society_systems: `Социологи изучают общественное восприятие концепции <strong>${word.toLowerCase()}и</strong> через опросы и фокус-группы.`,
                medicine_health: `Современные медицинские центры активно внедряют технологии <strong>${word.toLowerCase()}и</strong> для повышения качества оказания медицинской помощи.`
            };
            
            return examples[context.category] || `Термин <strong>${word}</strong> представляет собой важный концептуальный инструмент для осмысления трансформации в соответствующей области.`;
        }
        
        // Функции для озвучивания текста
        function speakArticle() {
            if (!speechSynthesis) {
                alert('Синтез речи не поддерживается вашим браузером');
                return;
            }
            
            if (isSpeaking) {
                stopSpeaking();
                return;
            }
            
            // Получаем текст статьи
            const articleText = articleContent.innerText;
            const titleText = articleTitle.innerText;
            const fullText = titleText + ". " + articleText;
            
            // Создаем объект utterance Озвучка текста
            currentUtterance = new SpeechSynthesisUtterance(fullText);
            currentUtterance.lang = 'ru-RU';
            currentUtterance.rate = 0.8; // МЕДЛЕННАЯ скорость для лучшего восприятия на телефоне
            currentUtterance.pitch = 1.0;
            currentUtterance.volume = 1;
            
            // События
            currentUtterance.onstart = function() {
                isSpeaking = true;
                speechStatus.classList.add('speech-active');
                speakBtn.innerHTML = '<i class="fas fa-pause-circle"></i> Пауза';
                speakBtn.classList.remove('btn-info');
                speakBtn.classList.add('btn-warning');
            };
            
            currentUtterance.onend = function() {
                isSpeaking = false;
                speechStatus.classList.remove('speech-active');
                speakBtn.innerHTML = '<i class="fas fa-volume-up"></i> Озвучить статью';
                speakBtn.classList.remove('btn-warning');
                speakBtn.classList.add('btn-info');
            };
            
            currentUtterance.onerror = function(event) {
                console.error('Ошибка синтеза речи:', event);
                isSpeaking = false;
                speechStatus.classList.remove('speech-active');
                speakBtn.innerHTML = '<i class="fas fa-volume-up"></i> Озвучить статью';
                speakBtn.classList.remove('btn-warning');
                speakBtn.classList.add('btn-info');
                
                if (event.error === 'interrupted') {
                    // Пользователь прервал речь - это нормально
                } else {
                    alert('Произошла ошибка при озвучивании текста');
                }
            };
            
            // Запускаем синтез речи
            speechSynthesis.speak(currentUtterance);
        }
        
        function stopSpeaking() {
            if (speechSynthesis && isSpeaking) {
                speechSynthesis.cancel();
                isSpeaking = false;
                speechStatus.classList.remove('speech-active');
                speakBtn.innerHTML = '<i class="fas fa-volume-up"></i> Озвучить статью';
                speakBtn.classList.remove('btn-warning');
                speakBtn.classList.add('btn-info');
            }
        }
        
        // Обработчики событий
        generateBtn.addEventListener('click', generateNewWord);
        
        voiceBtn.addEventListener('click', function() {
            if (!recognition) {
                alert('Голосовой ввод не поддерживается вашим браузером. Пожалуйста, используйте последние версии Chrome, Edge или Safari.');
                return;
            }
            
            if (isListening) {
                // Останавливаем запись
                recognition.stop();
                isListening = false;
                voiceStatus.classList.remove('voice-active');
                voiceBtn.innerHTML = '<i class="fas fa-microphone"></i> Голосовой ввод';
                voiceBtn.classList.remove('btn-danger');
                voiceBtn.classList.add('btn-secondary');
                definitionInput.placeholder = "Опишите понятие, для которого нужно создать новое слово...";
            } else {
                // Начинаем запись
                try {
                    // Очищаем поле ввода перед началом записи
                    definitionInput.value = '';
                    recognition.start();
                } catch (error) {
                    console.error('Ошибка запуска распознавания речи:', error);
                    alert('Не удалось начать запись. Пожалуйста, проверьте разрешения для микрофона и попробуйте еще раз.');
                }
            }
        });
        
        clearBtn.addEventListener('click', function() {
            definitionInput.value = '';
            definitionInput.focus();
        });
        
        legalizeBtn.addEventListener('click', legalizeTerm);
        
        speakBtn.addEventListener('click', speakArticle);
        
        stopSpeakBtn.addEventListener('click', stopSpeaking);
        
        // Обработчики для примеров
        exampleItems.forEach(item => {
            item.addEventListener('click', function() {
                const example = this.getAttribute('data-example');
                definitionInput.value = example;
                definitionInput.focus();
                
                // Автоматически генерируем слово для примера
                setTimeout(generateNewWord, 300);
            });
        });
        
        // Обработка нажатия Enter в текстовом поле
        definitionInput.addEventListener('keydown', function(event) {
            if (event.key === 'Enter' && event.ctrlKey) {
                generateNewWord();
            }
        });
        
        // Инициализация: показываем пример при загрузке
        window.addEventListener('load', function() {
            definitionInput.value = "должность человека который будет обучать роботов";
        });
    </script>
</body>
</html>